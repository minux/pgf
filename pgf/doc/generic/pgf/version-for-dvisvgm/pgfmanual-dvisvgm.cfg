% Copyright 2006 by Till Tantau
%
% This file may be distributed and/or modified
%
% 1. under the LaTeX Project Public License and/or
% 2. under the GNU Free Documentation License.
%
% See the file doc/generic/pgf/licenses/LICENSE for more details.

\def\pgfsysdriver{pgfsys-dvisvgm.def}

\usepackage[hypertex]{hyperref}


% Make sure to compile this using lualatex.


% Add forward button to each page:

\usepackage{everyshi}

\makeatletter
\newbox\pgfmanualbuttonbox
\newcount\pgfmanualcount

\EveryShipout{%%
  \setbox255=\vbox{%
    \pgfkeys{/pgf/fpu=false}%
    \@tempdima=\ht255\relax%
    \unvbox255%
    \vskip-\@tempdima%
    \let\protect=\relax%
    \pgfmanualcount=\c@page%
    \advance\pgfmanualcount by-1\relax%
    \ifnum\pgfmanualcount>0\relax%
      \begin{pgfpicture}{1in}{-1in}{1in}{-1in}
        \special{dvisvgm:raw <g pointer-events="all" visibility="hidden">}
	\pgftext[top,left]{\href{\jobname-\pgfmanualpadded{\pgfmanualcount}.svg}{{\color{white}\vrule width 2cm height \paperheight}}}
        \special{dvisvgm:raw </g>}
      \end{pgfpicture}%
    \fi%
    \advance\pgfmanualcount by2\relax%
    \begin{pgfpicture}{-\paperwidth+1in}{-1in}{-\paperwidth+1in}{-1in}
      \special{dvisvgm:raw <g pointer-events="all" visibility="hidden">}
      \pgftext[top,right]{\href{\jobname-\pgfmanualpadded{\pgfmanualcount}.svg}{\color{white}{\vrule width 2cm height \paperheight}}}
      \special{dvisvgm:raw </g>}
    \end{pgfpicture}%
  }%
}
\def\pgfmanualpadded#1{%
  \ifnum#1<1000 0\fi%
  \ifnum#1<100 0\fi%
  \ifnum#1<10 0\fi%
  \the#1%
}


{
  \def\sectiontext{section}
  \def\parttext{part}
  \newwrite\htmlfile
  \immediate\openout\htmlfile=pgfmanual-toc.html
  \def\numberline#1{}
  \def\emph#1{#1}
  \def\hspace#1{}
  \def\LaTeX{LaTeX}
  \def\textsc#1{#1}
  \def\textmd#1{#1}
  \def\contentsline#1#2#3#4{
    \def\temp{#1}
    \ifx\temp\sectiontext
      \immediate\write\htmlfile{<li>#2</li>}
    \fi
    \ifx\temp\parttext
      \immediate\write\htmlfile{<li><b>Part #2</b></li>}
    \fi
  }
  \input{pgfmanual.toc}
  \closeout\htmlfile
}


\makeatother



